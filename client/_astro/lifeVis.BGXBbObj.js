import{j as Y}from"./jsx-runtime.D_zvdyIk.js";import{r as Z}from"./index.RH_Wq4ov.js";import{S as k,P as q,W as J,a as $,M as K,b as Q,O as U,R as _,V as ee}from"./OrbitControls.Bn8mG_4i.js";let a=[],f=[];const N=0;let te=50,E=!1,P=0,D,H,L=2,T;const F=[{survive:[2,3],birth:[3]},{survive:[],birth:[1,2]},{survive:[3,4,6,7,8],birth:[3,6,7,8]},{survive:[1,2,3,4,5],birth:[3]},{survive:[4,5,6,7,8],birth:[3]},{survive:[2,4,5],birth:[3,6,8]},{survive:[4,6,7,8],birth:[3,5,6,7,8]}];function B(h,g){for(let n=0;n<g;n++){a[n]=[],f[n]=[];for(let c=0;c<h;c++)a[n][c]=Math.random()<.4?1:0,f[n][c]=0}}function ne(h,g){let n=0;const c=F[L];for(let i=0;i<g;i++)for(let e=0;e<h;e++){const u=ie(e,i,h,g);a[i][e]===1?c.survive.includes(u)?f[i][e]=1:(f[i][e]=0,n++):c.birth.includes(u)?(f[i][e]=1,n++):f[i][e]=0}return[a,f]=[f,a],n}function ie(h,g,n,c){let i=0;for(let e=-1;e<=1;e++)for(let u=-1;u<=1;u++){if(u===0&&e===0)continue;const r=h+u,s=g+e;r>=0&&r<n&&s>=0&&s<c&&(i+=a[s][r])}return i}function oe(h){let g,n,c,i,e,u,r,s,S,R,m;function O(){g=new k,n=new q(52,window.innerWidth/window.innerHeight,.1,1e3),c=new J,c.setSize(window.innerWidth,window.innerHeight),e=document.createElement("canvas"),e.width=window.innerWidth,e.height=window.innerHeight,e.classList.add("pointer"),e.style.zIndex="1",u=e.getContext("2d"),document.getElementById(h).appendChild(e),d(),(!a.length||!a[0].length)&&B(r,s);function d(){const w=Math.min(window.innerWidth,window.innerHeight)<768;let p;w?p=250:p=350;const x=Math.min(window.innerWidth,window.innerHeight)/p,o=Math.floor(window.innerWidth/x),l=Math.floor(window.innerHeight/x);if(S=window.innerWidth/o,R=window.innerHeight/l,m)m.geometry.dispose(),m.geometry=new $(o,l);else{const v=new $(o,l),b=new K({visible:!1});m=new Q(v,b),m.position.set(0,0,0),g.add(m)}if(n.position.z=p,r!==o||s!==l){const v=a.map(y=>[...y]),b=r,G=s;r=o,s=l,v.length>0&&t(v,b,G)}else r=o,s=l;i||(i=new U(n,c.domElement),i.enableDamping=!0,i.dampingFactor=.25,i.enableZoom=!1),D=D||new _,H=H||new ee}function t(w,p,x){a=[],f=[];for(let o=0;o<s;o++){a[o]=[],f[o]=[];for(let l=0;l<r;l++)l<p&&o<x?a[o][l]=w[o][l]:a[o][l]=0,f[o][l]=0}}X(),V()}function V(){T&&clearInterval(T);const t=Math.min(window.innerWidth,window.innerHeight)<768?75:te;T=setInterval(()=>{const w=ne(r,s);A(),w===0&&B(r,s),i.update()},t)}function A(){u.clearRect(0,0,e.width,e.height);for(let d=0;d<s;d++)for(let t=0;t<r;t++)a[d][t]===1&&(u.fillStyle=`rgb(${N},${N},${N})`,u.fillRect(t*S,d*R,S+.5,R+.5))}function X(){e.addEventListener("mousedown",t=>{t.button===2?(t.preventDefault(),z()):(E=!0,P=Date.now(),M(t,!0))});let d=0;e.addEventListener("touchstart",t=>{t.touches.length===2&&(d=Date.now(),t.preventDefault())}),e.addEventListener("touchend",t=>{t.changedTouches.length===2&&d>0&&(Date.now()-d<300&&z(),d=0)}),e.addEventListener("mouseup",()=>{E=!1}),e.addEventListener("mousemove",t=>{E?M(t,!0):M(t,!1)}),e.addEventListener("touchstart",t=>{E=!0,P=Date.now(),M(t.touches[0],!0),t.targetTouches.length===2&&z()}),e.addEventListener("touchend",()=>{E=!1}),e.addEventListener("touchmove",t=>{E?M(t.touches[0],!0):M(t.touches[0],!1)}),e.addEventListener("contextmenu",t=>t.preventDefault()),window.addEventListener("resize",()=>{e.width=window.innerWidth,e.height=window.innerHeight,c.setSize(window.innerWidth,window.innerHeight),n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),setupGrid()})}function M(d,t){const w=e.getBoundingClientRect();H.x=(d.clientX-w.left)/w.width*2-1,H.y=-((d.clientY-w.top)/w.height)*2+1,D.setFromCamera(H,n);const p=D.intersectObject(m);if(p.length>0){const x=p[0],o=x.point.x+r/2,l=s/2-x.point.y,v=Math.floor(o*r/m.geometry.parameters.width),b=Math.floor(l*s/m.geometry.parameters.height);if(v>=0&&v<r&&b>=0&&b<s){const G=Math.min(window.innerWidth,window.innerHeight)<768;let y=G?2:3;if(t){const W=Math.floor((Date.now()-P)/1e3);y=Math.floor((G?1.5:2)*Math.pow(2,W))}for(let W=-y;W<y;W++)for(let C=-y;C<y;C++){const j=v+C,I=b+W;j>=0&&j<r&&I>=0&&I<s&&(a[I][j]=1)}}}}function z(){L=(L+1)%F.length,console.log(`Switched to rule set: ${L}`)}O()}function de({containerId:h="lifeContainer1"}){return Z.useEffect(()=>{oe(h)},[h]),Y.jsx("div",{id:h,className:"vis-container"})}export{de as default};
